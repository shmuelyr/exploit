#!/usr/bin/python

from binascii import hexlify
from sys import argv
from struct import unpack, pack
from socket import *

def main(host):
	s = socket()
	s.connect((host, 2997))
	s.settimeout(5)
	print "[+] Connected and recved data.."
	sum = 0
	for i in range(4):
		d= s.recv(4)
		print "\t[+] Getting %s %d %s" % (d, int(hexlify(d),16), hexlify(d))
		l = unpack("<I", d)[0]
		sum += l
		sum &= 0xFFFFFFFF
	print "-"*30
	print "\t[+] sum is %d (0x%x)" % (sum, sum)
	sum = pack("<I", sum)
	s.send(sum)
	f = s.recv(1024)
	print f
	s.close()
	raw_input("Hit on any key..")


if __name__ == '__main__':
	if len(argv) > 1:
		main(argv[1])
	else:
		print "usage : %s <ip addr>" % argv[0]
