#!/usr/bin/python
# net1 solution
from binascii import hexlify
from struct import pack
from sys import argv
from socket import *

PORT = 2998

def main(host):

	s = socket()
	s.connect((host,PORT))
	s.settimeout(5)
	print "[+] connect to " + host +":"+str(PORT)
	value = s.recv(512)
	value = int(hexlify(value),16)
	print "[+] recv : %d (0x%x)" % (value,value)

	value = pack("<I", value)
	value = int(hexlify(value),16)
	print "[+] send :  %d (0x%x)" % (value,value)

	s.send("%d" % value)
	print s.recv(1024)
	a = raw_input("Enter space to exit..")

if __name__ == '__main__':
	if len(argv) > 1:
		main(argv[1])
	else:
		print "usage : %s <ip addr>" % argv[0]
